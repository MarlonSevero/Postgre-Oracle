
-- -- üì¶ CREATE TABLE

/*
    CREATE TABLE T_EXEMPLO (
     ID INTEGER,
     NOME VARCHAR(50)
    ); 
 */

---- üîê CONSTRAINTS

    -- Chave Prim√°ria
        -- ALTER TABLE T_EXEMPLO ADD CONSTRAINT pk_exemplo PRIMARY KEY (ID);

    -- Valor √önico
        -- ALTER TABLE T_EXEMPLO ADD CONSTRAINT un_exemplo UNIQUE (NOME);

    -- Valida√ß√£o
        -- ALTER TABLE T_EXEMPLO ADD CONSTRAINT ck_exemplo CHECK (ID > 0);

    -- Chave Estrangeira
        -- ALTER TABLE T_EXEMPLO ADD CONSTRAINT fk_exemplo FOREIGN KEY (ID_DEP) REFERENCES OUTRA_TABELA(ID);


---- ‚ûï ALTER TABLE - Adicionar Colunas
    -- ALTER TABLE T_EXEMPLO ADD COLUMN COL1 VARCHAR(20), ADD COLUMN COL2 INTEGER;


---- üõ†Ô∏è ALTER TABLE - Modificar Colunas
    -- ALTER TABLE T_EXEMPLO ALTER COLUMN COL2 TYPE NUMERIC(10);
    -- ALTER TABLE T_EXEMPLO ALTER COLUMN COL2 SET NOT NULL;
    -- ALTER TABLE T_EXEMPLO ALTER COLUMN COL2 DROP NOT NULL;


---- ‚úèÔ∏è Renomear

    -- -- Renomear coluna:
        -- ALTER TABLE T_EXEMPLO RENAME COLUMN COL1 TO NOVO_COL;

    -- -- Renomear tabela:
        -- ALTER TABLE T_EXEMPLO RENAME TO NOVA_TABELA;


---- üí¨ Coment√°rios

    -- COMMENT ON COLUMN T_EXEMPLO.COL1 IS 'Descricao da coluna';
    -- COMMENT ON TABLE T_EXEMPLO IS 'Descricao da tabela';


---- üìå DEFAULT
    /* 
    CREATE TABLE T_EXEMPLO_DEFAULT (
        ID INTEGER DEFAULT 0,
        STATUS VARCHAR(10) DEFAULT 'ativo',
        DT_CADASTRO TIMESTAMP DEFAULT CURRENT_TIMESTAMP
     ); 
     */

    ---- Adicionar ou Remover DEFAULT
    -- ALTER TABLE T_EXEMPLO_DEFAULT ALTER COLUMN STATUS SET DEFAULT 'ativo';
    -- ALTER TABLE T_EXEMPLO_DEFAULT ALTER COLUMN STATUS DROP DEFAULT;


---- üóëÔ∏è DROP

    ---- Apagar tabela com depend√™ncias:
        -- DROP TABLE IF EXISTS T_EXEMPLO CASCADE;

    ---- Apagar constraint:
        -- ALTER TABLE T_EXEMPLO DROP CONSTRAINT nome_constraint;

    ---- Apagar v√°rias colunas:
        -- ALTER TABLE T_EXEMPLO
        -- DROP COLUMN COL1,
        -- DROP COLUMN COL2;


---- üî¢ SEQUENCES

---- Criar sequence:
    -- CREATE SEQUENCE SQ_EXEMPLO
    -- START 1 INCREMENT 1 MAXVALUE 1000
    -- CACHE 1
    -- NO CYCLE;

---- Usar sequence em insert:
    -- INSERT INTO T_EXEMPLO (ID, NOME) VALUES (nextval('SQ_EXEMPLO'), 'Fulano');

---- Obter valor atual:
    -- SELECT currval('SQ_EXEMPLO');

---- Alterar sequence:
    -- ALTER SEQUENCE SQ_EXEMPLO INCREMENT BY 2 MAXVALUE 5000 RESTART WITH 10;


---- üÜî GENERATED IDENTITY

    ---- Criar tabela com ID gerado automaticamente:
        /*
        CREATE TABLE T_USUARIOS (
             ID_USER INT GENERATED ALWAYS AS IDENTITY NOT NULL,
             NOME_USER VARCHAR(10) NOT NULL
         );
        */

---- Op√ß√µes:
    -- GENERATED ALWAYS AS IDENTITY: PostgreSQL sempre gera.
    -- GENERATED BY DEFAULT AS IDENTITY: voc√™ pode inserir valores se quiser.

---- Inserir:
    -- INSERT INTO T_USUARIOS (NOME_USER) VALUES ('Joao');


-- -- üí° RESUMO FINAL

    ---- DDL: CREATE, ALTER, DROP, COMMENT, CONSTRAINTS, SEQUENCE, IDENTITY
    ---- DML: INSERT com DEFAULT, NEXTVAL, CURRVAL
    ---- PostgreSQL usa CURRENT_TIMESTAMP ao inv√©s de SYSDATE
    ---- N√£o tem CASCADE CONSTRAINTS, apenas CASCADE
    ---- Sempre usa ALTER COLUMN para mudar propriedades de colunas

